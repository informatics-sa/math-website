---
id: participations
layout: default
---

<style>
:root {
    --primary-color: #1A8754;
    --dark-color: #000000;
    --light-color: #FFFFFF;
    --success-color: #1A8754;
    --warning-color: #ffc107;
    --info-color: #0dcaf0;
    --secondary-color: #6c757d;
}

.olympiad-container {
    background: var(--light-color);
    border-radius: 12px;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.1);
    padding: 25px;
    margin: 20px 0;
}

.filter-section {
    background: linear-gradient(135deg, var(--primary-color), #228B5B);
    color: var(--light-color);
    border-radius: 10px;
    padding: 20px;
    margin-bottom: 25px;
}

.filter-controls {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
    align-items: center;
    justify-content: center;
}

.olympiad-checkbox {
    display: flex;
    align-items: center;
    background: rgba(255, 255, 255, 0.15);
    padding: 8px 15px;
    border-radius: 25px;
    border: 2px solid transparent;
    transition: all 0.3s ease;
    cursor: pointer;
    margin: 5px;
}

.olympiad-checkbox:hover {
    background: rgba(255, 255, 255, 0.25);
    border-color: var(--light-color);
}

.olympiad-checkbox input[type="checkbox"] {
    margin-left: 10px;
    transform: scale(1.2);
    accent-color: var(--light-color);
}

.olympiad-checkbox label {
    color: var(--light-color);
    font-weight: 500;
    cursor: pointer;
    margin: 0;
}

.control-buttons {
    display: flex;
    gap: 10px;
    margin-top: 15px;
    justify-content: center;
}

.btn-custom {
    background: var(--light-color);
    color: var(--primary-color);
    border: none;
    padding: 8px 20px;
    border-radius: 20px;
    font-weight: 600;
    transition: all 0.3s ease;
}

.btn-custom:hover {
    background: #f0f0f0;
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
}

.table-container {
    overflow-x: auto;
    border-radius: 10px;
    border: 1px solid #e0e0e0;
}

.table {
    margin: 0;
    background: var(--light-color);
}

.table thead th {
    background: linear-gradient(135deg, var(--primary-color), #228B5B);
    color: var(--light-color);
    border: none;
    font-weight: 600;
    text-align: center;
    padding: 15px;
    position: sticky;
    top: 0;
    z-index: 10;
}

.table tbody tr {
    transition: all 0.3s ease;
    border-bottom: 1px solid #f0f0f0;
}

.table tbody tr:hover {
    background: linear-gradient(135deg, rgba(26, 135, 84, 0.05), rgba(26, 135, 84, 0.02));
    transform: scale(1.01);
}

.table tbody td {
    padding: 12px 15px;
    vertical-align: middle;
    border: none;
}

.year-cell {
    background: linear-gradient(135deg, #f8f9fa, #e9ecef);
    font-weight: bold;
    font-size: 1.1em;
    color: var(--primary-color);
    text-align: center;
}

.olympiad-link {
    color: var(--primary-color);
    text-decoration: none;
    font-weight: 600;
    transition: all 0.3s ease;
}

.olympiad-link:hover {
    color: #228B5B;
    text-decoration: underline;
}

.badge {
    font-size: 0.8em;
    padding: 6px 12px;
    border-radius: 15px;
    font-weight: 500;
}

.bg-success {
    background-color: var(--success-color) !important;
}

.bg-warning {
    background-color: var(--warning-color) !important;
    color: var(--dark-color) !important;
}

.bg-info {
    background-color: var(--info-color) !important;
}

.bg-secondary {
    background-color: var(--secondary-color) !important;
}

.no-results {
    text-align: center;
    padding: 40px;
    color: var(--secondary-color);
    font-size: 1.2em;
}

@media (max-width: 768px) {
    .filter-controls {
        flex-direction: column;
    }
    
    .olympiad-checkbox {
        width: 100%;
        justify-content: center;
    }
    
    .table-container {
        font-size: 0.9em;
    }
}
</style>

<div class="olympiad-container">
    <!-- Filter Section -->
    <div class="filter-section">
        <h4 class="text-center mb-3">
            {% if page.lang == "ar" %}
                تصفية الأولمبيادات
            {% else %}
                Filter Olympiads
            {% endif %}
        </h4>
        
        <div class="filter-controls" id="filterControls">
            <!-- Checkboxes will be populated by JavaScript -->
        </div>
        
        <div class="control-buttons">
            <button class="btn btn-custom" onclick="selectAll()">
                {% if page.lang == "ar" %}
                    تحديد الكل
                {% else %}
                    Select All
                {% endif %}
            </button>
            <button class="btn btn-custom" onclick="deselectAll()">
                {% if page.lang == "ar" %}
                    إلغاء تحديد الكل
                {% else %}
                    Deselect All
                {% endif %}
            </button>
        </div>
    </div>

    <!-- Table -->
    <div class="table-container">
        <table class="table table-bordered table-striped">
            <thead>
                {% if page.lang == "ar" %}
                <th width="5%">السنة</th>
                <th>الأولمبياد</th>
                <th>تاريخ المشاركة</th>
                <th>المكان</th>
                <th>الجوائز</th>
                {% else %}
                <th width="5%">Year</th>
                <th>Olympiad</th>
                <th>Date</th>
                <th>Country</th>
                <th>Awards</th>
                {% endif %}
            </thead>
            <tbody id="olympiadTableBody">
                {% for year in (page.start_year..page.last_year) reversed %}
                    {% for idx in (1..page[year].count) %}
                        {% capture olyid %}{{page[year][idx].name}}_{{year}}{% endcapture %}
                        <tr class="olympiad-row" data-olympiad="{{ page[year][idx].name }}">
                            {% if idx == 1 %}
                            <td class="text-center year-cell" style="vertical-align: middle;" rowspan="{{ page[year].count }}">{{ year }}</td>
                            {% endif %}
                            <td>
                                <a href="{% if page.lang == "en" %}/en{% endif %}/participations/{{olyid}}" class="olympiad-link">
                                    {% if page.lang == "en" %}  
                                        {{ page[year][idx].enname }}
                                    {% else %}
                                        {{ page[year][idx].arname }}
                                    {% endif %}
                                    ({{ page[year][idx].name | upcase }})
                                </a>
                            </td>
                            <td>
                                <input type="hidden" id="olstart-{{olyid}}" value="{{ page[year][idx].start }}">
                                <input type="hidden" id="olend-{{olyid}}" value="{{ page[year][idx].end }}">
                                {% if page[year][idx].start == page[year][idx].end %}
                                    {{ page[year][idx].start }}
                                {% else %}
                                    {{ page[year][idx].start }} - {{ page[year][idx].end }}
                                {% endif %}
                            </td>
                            <td>
                                {% if page.lang == 'ar' %}
                                    {{ page[year][idx].country_arname }}
                                {% else %}
                                    {{ page[year][idx].country_enname }}
                                {% endif %}
                                
                                {% if page[year][idx].online %}
                                <span class="badge bg-secondary">
                                    {% if page.lang == 'ar' %}
                                    عن بعد 🌐
                                    {% else %}
                                    Online 🌐
                                    {% endif %}
                                </span>
                                {% endif %}
                            </td>
                            <td id="olawards-{{olyid}}">
                                {{ page[year][idx].awards }}
                            </td>
                        </tr>
                    {% endfor %}
                {% endfor %}
            </tbody>
        </table>
        
        <div id="noResults" class="no-results" style="display: none;">
            {% if page.lang == "ar" %}
                لا توجد نتائج تطابق التصفية المحددة
            {% else %}
                No results match the selected filters
            {% endif %}
        </div>
    </div>
</div>

<script>
// Global variables
let olympiadTypes = new Set();
const isArabic = document.documentElement.lang === 'ar';

// Initialize page
document.addEventListener('DOMContentLoaded', function() {
    collectOlympiadTypes();
    createFilterControls();
    refresh_tags();
});

// Collect all unique olympiad types
function collectOlympiadTypes() {
    const rows = document.querySelectorAll('.olympiad-row');
    rows.forEach(row => {
        const olympiadName = row.dataset.olympiad;
        if (olympiadName) {
            olympiadTypes.add(olympiadName);
        }
    });
}

// Create filter control checkboxes
function createFilterControls() {
    const filterControls = document.getElementById('filterControls');
    
    olympiadTypes.forEach(olympiadName => {
        const checkboxContainer = document.createElement('div');
        checkboxContainer.className = 'olympiad-checkbox';
        
        const checkbox = document.createElement('input');
        checkbox.type = 'checkbox';
        checkbox.id = `filter-${olympiadName}`;
        checkbox.checked = true; // Default: all visible
        checkbox.addEventListener('change', filterTable);
        
        const label = document.createElement('label');
        label.htmlFor = `filter-${olympiadName}`;
        label.textContent = olympiadName.toUpperCase();
        
        checkboxContainer.appendChild(label);
        checkboxContainer.appendChild(checkbox);
        filterControls.appendChild(checkboxContainer);
    });
}

// Filter table based on selected checkboxes
function filterTable() {
    const rows = document.querySelectorAll('.olympiad-row');
    const noResults = document.getElementById('noResults');
    let visibleRows = 0;
    let currentYear = null;
    let yearRowSpan = 0;
    let yearCell = null;
    
    // First pass: count visible rows per year and hide/show rows
    const yearVisibility = {};
    
    rows.forEach(row => {
        const olympiadName = row.dataset.olympiad;
        const checkbox = document.getElementById(`filter-${olympiadName}`);
        const isVisible = checkbox && checkbox.checked;
        
        // Get year from previous sibling or current row
        const yearCellInRow = row.querySelector('.year-cell');
        if (yearCellInRow) {
            currentYear = yearCellInRow.textContent.trim();
            yearVisibility[currentYear] = yearVisibility[currentYear] || 0;
        }
        
        if (isVisible) {
            row.style.display = '';
            visibleRows++;
            if (currentYear) {
                yearVisibility[currentYear]++;
            }
        } else {
            row.style.display = 'none';
        }
    });
    
    // Second pass: update rowspan for year cells
    rows.forEach(row => {
        const yearCellInRow = row.querySelector('.year-cell');
        if (yearCellInRow) {
            const year = yearCellInRow.textContent.trim();
            const visibleCount = yearVisibility[year] || 0;
            if (visibleCount > 0) {
                yearCellInRow.setAttribute('rowspan', visibleCount);
                row.style.display = '';
            } else {
                row.style.display = 'none';
            }
        }
    });
    
    // Show/hide no results message
    if (visibleRows === 0) {
        noResults.style.display = 'block';
    } else {
        noResults.style.display = 'none';
    }
}

// Select all checkboxes
function selectAll() {
    olympiadTypes.forEach(olympiadName => {
        const checkbox = document.getElementById(`filter-${olympiadName}`);
        if (checkbox) {
            checkbox.checked = true;
        }
    });
    filterTable();
}

// Deselect all checkboxes
function deselectAll() {
    olympiadTypes.forEach(olympiadName => {
        const checkbox = document.getElementById(`filter-${olympiadName}`);
        if (checkbox) {
            checkbox.checked = false;
        }
    });
    filterTable();
}

// Enhanced refresh_tags function with better styling
function refresh_tags() {
    const today = new Date();
    today.setHours(0, 0, 0, 0);
    
    function daysDifference(date1, date2) {
        const diffTime = Math.abs(date2 - date1);
        return Math.ceil(diffTime / (1000 * 60 * 60 * 24));
    }
    
    function parseDate(dateStr) {
        if (!dateStr) return null;
        
        const parts = dateStr.split('/');
        if (parts.length !== 3) return null;
        
        const year = parseInt(parts[0], 10);
        const month = parseInt(parts[1], 10) - 1;
        const day = parseInt(parts[2], 10);
        
        const parsedDate = new Date(year, month, day);
        
        return isNaN(parsedDate.getTime()) ? null : parsedDate;
    }
    
    function createBadge(text, type = 'info') {
        const badgeClass = type === 'warning' ? 'bg-warning' : 
                          type === 'success' ? 'bg-success' : 
                          type === 'info' ? 'bg-info' : 'bg-secondary';
        return `<span class="badge ${badgeClass} ms-2">${text}</span>`;
    }
    
    const allOlympiads = document.querySelectorAll('[id^="olstart-"]');
    
    function arabicDaysStr(days) {
        if (days == 1) return "يوم";
        if (days == 2) return "يومين";
        if (days <= 10) return `${days} أيام`;
        return `${days} يوم`;
    }

    allOlympiads.forEach(function(startElement) {
        const olyid = startElement.id.replace('olstart-', '');
        const endElement = document.getElementById('olend-' + olyid);
        const awardsElement = document.getElementById('olawards-' + olyid);
        
        if (!endElement || !awardsElement) return;
        
        const startDateStr = startElement.value;
        const endDateStr = endElement.value;
        const awards = awardsElement.textContent.trim();
        
        const startDate = parseDate(startDateStr);
        const endDate = parseDate(endDateStr);
        
        if (!startDate || !endDate) return;
        
        let badgeHtml = '';
        
        if (today < startDate) {
            const daysToStart = daysDifference(today, startDate);
            const text = isArabic ? 
                `سيبدأ بعد ${arabicDaysStr(daysToStart)}` :
                `Will start in ${daysToStart} day${daysToStart === 1 ? '' : 's'}`;
            badgeHtml = createBadge(text, 'info');
            
        } else if (today >= startDate && today <= endDate) {
            const daysToEnd = daysDifference(today, endDate);
            const text = isArabic ? 
                `سينتهي بعد ${arabicDaysStr(daysToEnd)}` :
                `Will finish in ${daysToEnd} day${daysToEnd === 1 ? '' : 's'}`;
            badgeHtml = createBadge(text, 'warning');
        }
        
        if (badgeHtml) {
            awardsElement.innerHTML += badgeHtml;
        }
    });
}
</script>
